#define BLYNK_PRINT Serial
#include <ESP8266WiFi.h>
#include <BlynkSimpleEsp8266.h>
#include <Servo.h>
#include<SoftwareSerial.h>
#define BLYNK_AUTH_TOKEN            "XR_yi3GogL_xbU6z8kHR_aVIGuEhh8i-"
// You should get Auth Token in the Blynk App.
char auth[] = BLYNK_AUTH_TOKEN; //my token
// Your WiFi credentials.
char ssid[] = "CYBERX"; //YourNetworkName
char pass[] = "cyberxander"; //YourPassword
BlynkTimer timer;
const byte enA = D1; // ENA for motor drive
const byte motorA1 = D2; // in1 for motor drive
const byte motorA2 = D3; // in2 for motor drive
const byte motorB1 = D4; // in3 for motor drive
const byte motorB2 = D5; // in4 for motor drive
const byte enB = D6; // ENB for motor drive


#define enA 500/*speed of motorA 
                  and motorB*/
#define enB 500
int ax ,ay;
void movement(int prmA, byte prmA1, byte prmA2, int prmB, byte prmB1, byte prmB2)
{
 analogWrite(enA,prmA);
 analogWrite(enB,prmB);
 digitalWrite(motorA1,prmA1);
 digitalWrite(motorA2,prmA2);
 digitalWrite(motorB1,prmB1);
 digitalWrite(motorB2,prmB2);
}
BLYNK_WRITE(V1) {
 ax = param[0].asInt();
 ay = param[1].asInt();
// x =  -10,10   
// Y =  -10,10
//value(ax,ay);
}
void value(int x,int y)
{
if ((x==0) && (y==0)) // stop
{
  Serial.println("stop00");
  //n
  
           movement(0,LOW,LOW,0,LOW,LOW); 
}
else if ((x>-4)&&(x<4)&&(y>=3)) // forward 
{
          movement(enA,HIGH,LOW,enB,HIGH,LOW); 
            Serial.println("forward");
  //n
}
else if ((x>-4)&&(x<4)&&(y<=-3)) // backward 
{//            movement(enA,LOW,HIGH,enB,LOW,HIGH); 
            Serial.println("back");
  //n
}
else if ((y>=-4) && (y<=4) && (x<=-3)) //sharp left 
    {        movement(enA,HIGH,LOW,enB,LOW,HIGH);
            Serial.println("sl");
  //n
    }
else if ((x<-4)&&(y>4)) //forward left 
      {      movement(700,HIGH,LOW,200,HIGH,LOW); 
            Serial.println("forward left");
              //n
      }
else if ((x>4)&&(y>4)) //forward right 
{            movement(200,HIGH,LOW,700,HIGH,LOW); 
                        Serial.println("fR");
  //n
}
else if ((y>=-4) && (y<=4) && (x>=3)) // sharp right 
 {                       Serial.println("sr");
  //n
 
            
            movement(enA,LOW,HIGH,enB,HIGH,LOW);
 } 
else if ((x<-4)&&(y<-4)) //backward left 
{            movement(200,LOW,HIGH,700,LOW,HIGH); 
            Serial.println("bL");
  //n
}

 else if ((x>4)&&(y<-4)) //BACKWARD right 
 { movement(700,LOW,HIGH,200,LOW,HIGH);    
            Serial.println("bR");
  //n
 }
 delay(300);
}

Servo servo;

BLYNK_WRITE(V3)
{
  servo.write(param.asInt());
  
}
void setup() {
 Serial.begin(115200);
 Blynk.begin(auth, ssid, pass, IPAddress(192,168,43,78), 8080);
// servo.attach(9);
// pinMode(motorA1,OUTPUT);
// pinMode(motorA2,OUTPUT);
// pinMode(motorB1,OUTPUT);
// pinMode(motorB2,OUTPUT);
//digitalWrite(motorA1,LOW);
//digitalWrite(motorA2,LOW);
//digitalWrite(motorB1,LOW);
//digitalWrite(motorB2,LOW);
//Blynk.begin(auth, ssid, pass, IPAddress(192,168,43,78), 8080);
//timer.setTimer(400, value,400);
}
void loop() {
 Blynk.run();
 timer.run();
value(ax,ay);
}
